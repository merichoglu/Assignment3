<div class="container">
  <h2>User Access Logs</h2>
  <div>Total logs: <b>{{ totalLogs }}</b></div>
  <div class="dropdown">
    <button aria-expanded="false" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" id="userDropdown" type="button">
      Select User
    </button>
    <ul aria-labelledby="userDropdown" class="dropdown-menu">
      <li *ngFor="let user of users">
        <a (click)="selectUser(user.username)" class="dropdown-item">{{ user.username }}</a>
      </li>
    </ul>
  </div>
  <div *ngIf="selectedUser"><h3>Logs for {{ selectedUser }}</h3></div>
  <table class="table table-striped table-bordered">
    <thead>
    <tr>
      <th (click)="sortLogs('accessLogs.loginTime')">Login Time <span *ngIf="sortBy === 'accessLogs.loginTime'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
      <th (click)="sortLogs('accessLogs.logoutTime')">Logout Time <span *ngIf="sortBy === 'accessLogs.logoutTime'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
      <th (click)="sortLogs('accessLogs.ip')">IP <span *ngIf="sortBy === 'accessLogs.ip'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
      <th (click)="sortLogs('accessLogs.browser')">Browser <span *ngIf="sortBy === 'accessLogs.browser'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let log of selectedUserLogs">
      <td>{{ log.loginTime | date:'medium' }}</td>
      <td>{{ log.logoutTime ? (log.logoutTime | date:'medium') : '-' }}</td>
      <td>{{ log.ip }}</td>
      <td>{{ log.browser }}</td>
    </tr>
    <tr *ngIf="!selectedUserLogs || selectedUserLogs.length === 0">
      <td class="text-center" colspan="4">No logs available</td>
    </tr>
    </tbody>
  </table>
  <nav aria-label="Page navigation">
    <ul class="pagination">
      <li [class.disabled]="page === 1" class="page-item">
        <a (click)="changePage(page - 1)" class="page-link">Previous</a>
      </li>
      <li *ngFor="let p of [].constructor(Math.ceil(totalLogs / limit)); let i = index" [class.active]="page === i + 1" class="page-item">
        <a (click)="changePage(i + 1)" class="page-link">{{ i + 1 }}</a>
      </li>
      <li [class.disabled]="page === Math.ceil(totalLogs / limit)" class="page-item">
        <a (click)="changePage(page + 1)" class="page-link">Next</a>
      </li>
    </ul>
  </nav>
</div>
